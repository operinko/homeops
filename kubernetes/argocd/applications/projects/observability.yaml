---
apiVersion: argoproj.io/v1alpha1
kind: AppProject
metadata:
  name: observability
  namespace: argocd
spec:
  description: Observability namespace project
  sourceRepos:
    - "https://github.com/operinko/homeops.git"
    - "https://bjw-s-labs.github.io/helm-charts"
    - "https://charts.fairwinds.com/stable"
    - "https://grafana.github.io/helm-charts"
    - "ghcr.io/grafana/helm-charts"
    - "ghcr.io/prometheus-community/charts"
    - "https://helm.elastic.co"
    - "https://robusta-charts.storage.googleapis.com"
  destinations:
    - namespace: "observability"
      server: "https://kubernetes.default.svc"
    - namespace: "kube-system"
      server: "https://kubernetes.default.svc"
  namespaceResourceWhitelist:
    - group: "*"
      kind: "*"
  clusterResourceWhitelist:
    - group: ""
      kind: Namespace
    - group: rbac.authorization.k8s.io
      kind: ClusterRole
    - group: rbac.authorization.k8s.io
      kind: ClusterRoleBinding
    - group: bitwarden.external-secrets.io
      kind: BitwardenSecret
    - group: apiextensions.k8s.io
      kind: CustomResourceDefinition
    - group: admissionregistration.k8s.io
      kind: MutatingWebhookConfiguration
    - group: admissionregistration.k8s.io
      kind: ValidatingWebhookConfiguration
  namespaceResourceBlacklist:
    - group: ""
      kind: ResourceQuota
    - group: ""
      kind: LimitRange
  orphanedResources:
    warn: true
    ignore:
      # Goldilocks creates VPA resources dynamically
      - group: autoscaling.k8s.io
        kind: VerticalPodAutoscaler
      # Standard Kubernetes resources
      - group: ""
        kind: ConfigMap
        name: kube-root-ca.crt
      - group: ""
        kind: Secret
        name: sh.helm.release.*

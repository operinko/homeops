---
# Helm values for falco-talon deployment
# Automated response engine for Falco events

# Replicas
replicaCount: 1

# Resources
resources:
  requests:
    cpu: 50m
    memory: 128Mi
  limits:
    memory: 256Mi

# Configuration
config:
  # Listen address
  listenAddress: "0.0.0.0"
  listenPort: 2803

  # Default notifiers for all rules
  defaultNotifiers:
    - k8sevents

  # Watch rules file changes
  watchRules: true

  # Print all events
  printAllEvents: false

  # Deduplication
  deduplication:
    leaderElection: true
    timeWindowSeconds: 5

  # Notifiers configuration
  notifiers:
    # Discord webhook (configured via secret)
    webhook:
      url: ""
    # Kubernetes events (always enabled)
    k8sevents: {}

  # Rules - DETECTION ONLY MODE
  # User-defined rules override
  rulesOverride: |
    # Log and notify on suspicious activity
    - action: Log
      actionner: log
      continue: true
      parameters:
        level: info

    # Create Kubernetes events for all Falco alerts
    - action: Create Event
      actionner: kubernetes:event
      continue: true

# Service Account
serviceAccount:
  create: true
  name: falco-talon

# RBAC
rbac:
  create: true

# Pod Security
podSecurityContext:
  runAsUser: 1234
  runAsNonRoot: true
  fsGroup: 1234

securityContext:
  runAsUser: 1234
  runAsNonRoot: true
  readOnlyRootFilesystem: true
  allowPrivilegeEscalation: false
  capabilities:
    drop:
      - ALL

# Service
service:
  type: ClusterIP
  port: 2803

# Environment variables from secret
envFrom:
  - secretRef:
      name: falco-talon-secret


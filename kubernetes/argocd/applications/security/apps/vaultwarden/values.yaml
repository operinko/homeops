controllers:
  vaultwarden:
    annotations:
      reloader.stakater.com/auto: "true"
    initContainers:
      init-db:
        image:
          repository: ghcr.io/home-operations/postgres-init
          tag: 17.6
        envFrom:
          - secretRef:
              name: vaultwarden-secret
    containers:
      app:
        image:
          repository: vaultwarden/server
          tag: 1.34.3@sha256:84fd8a47f58d79a1ad824c27be0a9492750c0fa5216b35c749863093bfa3c3d7
        env:
          DATA_FOLDER: "config"
          ICON_CACHE_FOLDER: "data/icon_cache"
          ATTACHMENTS_FOLDER: "data/attachments"
          DOMAIN: https://vaultwarden.vaderrp.com
          SIGNUPS_ALLOWED: "false"
          SMTP_FROM_NAME: Vaultwarden
          SMTP_PORT: 587
          SMTP_SSL: "true"
          SMTP_EXPLICIT_TLS: "true"
          TZ: Europe/Helsinki
          WEBSOCKET_ADDRESS: 0.0.0.0
          WEBSOCKET_ENABLED: true
          WEBSOCKET_PORT: 3012
        envFrom:
          - secretRef:
              name: vaultwarden-secret
        resources:
          requests:
            cpu: 100m
            memory: 100Mi
          limits:
            memory: 2Gi
service:
  app:
    controller: vaultwarden
    ports:
      http:
        port: 80
      websocket:
        enabled: true
        port: 3012
ingress:
  app:
    enabled: false
persistence:
  config:
    existingClaim: vaultwarden
    globalMounts:
      - path: /config


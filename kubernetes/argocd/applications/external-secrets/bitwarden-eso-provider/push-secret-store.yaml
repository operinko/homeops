---
# SecretStore for pushing to Bitwarden via webhook
apiVersion: external-secrets.io/v1
kind: SecretStore
metadata:
  name: bitwarden-push
  namespace: bitwarden-external-secrets
spec:
  provider:
    webhook:
      url: "http://bitwarden-eso-provider.bitwarden-external-secrets.svc.cluster.local:8087/object/item/{{ .remoteRef.remoteKey }}"
      method: PUT
      headers:
        Content-Type: application/json
      # Body template - the secret data will be available in the template context
      body: |
        {
          "id": "{{ .remoteRef.remoteKey }}",
          "type": 1,
          "name": "{{ .remoteRef.name }}",
          "folderId": "94fa1633-a293-4e43-9557-b8b6da7cfe66",
          "notes": "Pushed from Kubernetes via PushSecret. Do not modify.",
          "login": {
            "username": "{{ .username }}",
            "password": "{{ .password }}"
          }
        }


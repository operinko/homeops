---
apiVersion: traefik.io/v1alpha1
kind: Middleware
metadata:
  name: authentik-forward
  namespace: ${TARGET_NAMESPACE:=default}
spec:
  plugin:
    authentik-forward:
      address: https://auth.vaderrp.com
      cacheDuration: "1m"
      skippedPaths:
        - "^/api([/?].*)?"
        - "^/identity.*"
        - "^/triggers.*$"
        - "^/meshagents.*"
        - "^/meshsettings.*"
        - "^/agent.*"
        - "^/control.*"
        - "^/meshrelay.*"
        - "^/wl.*$"
      unauthorizedPaths:
        - "^/admin/.*$"
      redirectPaths:
        - "^/app/.*$"
        - "^/.*$"
      redirectStatusCode: 302
      timeout: "30s"


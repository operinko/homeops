---
apiVersion: v1
kind: ConfigMap
metadata:
  name: traefik-crowdsec-pages
  labels:
    app.kubernetes.io/name: traefik-crowdsec-pages

data:
  captcha.html: |
    <!DOCTYPE html>
    <html lang="en">
      <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>CrowdSec Captcha</title>
        <style>
          body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif; }
          .wrap { min-height: 100vh; display: flex; align-items: center; justify-content: center; padding: 24px; }
          .card { max-width: 680px; width: 100%; border: 1px solid #e5e7eb; border-radius: 12px; padding: 24px; }
          .title { font-size: 24px; font-weight: 700; margin: 12px 0 16px; text-align: center; }
          .hint { color: #4b5563; font-size: 14px; text-align: center; margin-top: 16px; }
          .brand { display: flex; align-items: center; justify-content: center; gap: 8px; margin-top: 20px; color: #111827; text-decoration: none; }
        </style>
        <script src="{{ .FrontendJS }}" async defer></script>
      </head>
      <body>
        <div class="wrap">
          <div class="card">
            <div style="text-align:center">
              <svg fill="black" width="64" height="64" viewBox="0 0 576 512" aria-hidden="true" role="img">
                <path d="M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"></path>
              </svg>
            </div>
            <div class="title">CrowdSec Captcha</div>
            <form action="" method="POST" id="captcha-form" style="display:flex;align-items:center;justify-content:center;">
              <div id="captcha" class="{{ .FrontendKey }}" data-sitekey="{{ .SiteKey }}" data-callback="captchaCallback"></div>
            </form>
            <div class="hint">This security check is powered by CrowdSec.</div>
            <a class="brand" href="https://crowdsec.net/" target="_blank" rel="noopener noreferrer">
              <span>CrowdSec</span>
            </a>
          </div>
        </div>
        <script>
          function captchaCallback(){ setTimeout(function(){ document.getElementById('captcha-form').submit(); }, 500); }
        </script>
      </body>
    </html>

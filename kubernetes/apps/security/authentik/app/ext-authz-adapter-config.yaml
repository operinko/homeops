---
apiVersion: v1
kind: ConfigMap
metadata:
  name: authentik-ext-authz-config
  namespace: security
  labels:
    app.kubernetes.io/name: authentik-ext-authz
    app.kubernetes.io/part-of: authentik
    app.kubernetes.io/component: ext-authz
data:
  config.yaml: |
    plugins:
      envoy_ext_authz:
        addr: :9191
        path: /envoy.service.auth.v3.Authorization/Check
        proto: envoy/service/auth/v3/external_auth.proto
        query: data.envoy.authz.allow
        # include_headers_in_check: ["cookie", "authorization", ":authority", "x-forwarded-proto", "x-forwarded-host"]


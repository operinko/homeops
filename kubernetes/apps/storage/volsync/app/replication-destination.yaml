---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: volsync-nfs-destination
spec:
  accessModes:
    - ReadWriteMany
  resources:
    requests:
      storage: 100Gi
  storageClassName: nfs-csi
---
apiVersion: volsync.backube/v1alpha1
kind: ReplicationDestination
metadata:
  name: nfs-destination
spec:
  trigger:
    manual: manual-trigger-1
  restic:
    # The repository PVC is using nfs-csi storage class
    # This is where the actual backup data will be stored
    repository: volsync-nfs-destination
    copyMethod: Snapshot
    # Cache is temporary storage used during backup operations
    cacheCapacity: 8Gi
    # Using Mayastor for the cache for better performance
    cacheStorageClassName: mayastor-3-replicas
    # The main storage for temporary volumes during backup operations
    storageClassName: mayastor-3-replicas
    volumeSnapshotClassName: csi-mayastor-snapshotclass
    accessModes:
      - ReadWriteOnce
    moverSecurityContext:
      runAsUser: 0
      runAsGroup: 0
      fsGroup: 0
    pruneIntervalDays: 7
    # Using encryption for the backups
    encryptionKeySecret:
      name: volsync-restic-secret

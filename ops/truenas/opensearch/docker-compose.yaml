version: "3.8"

services:
  opensearch:
    image: bitnami/opensearch:3.2.0
    container_name: opensearch
    restart: unless-stopped
    environment:
      # Single-node mode
      - OPENSEARCH_ENABLE_SINGLE_NODE=true
      # Disable security initially for easy bootstrap; we'll enable later
      - OPENSEARCH_ENABLE_SECURITY=no
      # Heap (adjust to your RAM)
      - OPENSEARCH_HEAP_SIZE=1g
      # Install required plugins at first start
      - OPENSEARCH_PLUGINS=repository-s3
      # Optional: reduce noisy logs
      - BITNAMI_DEBUG=false
    volumes:
      # CHANGE THIS PATH to your TrueNAS dataset
      - /mnt/Nakkiallas/OpenSearch:/bitnami/opensearch
    ports:
      - "9200:9200"
    ulimits:
      memlock:
        soft: -1
        hard: -1
      nofile:
        soft: 65536
        hard: 65536

